# -*- coding: utf-8 -*-
"""Predict.ipynb

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/1VXBACLIdq0jQaE1StYn43IiWLCLcd-3A
"""

#importar librerías
from sklearn.model_selection import train_test_split
from sklearn.linear_model import LinearRegression
from sklearn import metrics
import pandas as pd
import numpy as np
import pickle
import os
from sklearn.metrics import r2_score

#Cargar la data de entrenamiento y test para validar
def load_and_test(name_x_train,name_y_train, name_x_test, name_y_test):
  #cargando las datas de entrenamiento y testeo
    X_train = pd.read_csv(os.path.join('../data/', name_x_train))
    Y_train = pd.read_csv(os.path.join('../data/', name_y_train))
    X_test = pd.read_csv(os.path.join('../data/', name_x_test))
    Y_test = pd.read_csv(os.path.join('../data/', name_y_test))
  #importando el modelo para la validación
    model_path = '../models/model_selected.pkl'
    with open(model_path, 'rb') as file:
        model = pickle.load(file)
    print('Modelo importado correctamente')
  #predicción para test y entrenamiento
    y_pred_slr= model.predict(X_test)
    x_pred_slr= model.predict(X_train)
  #validando y guardando los resultados
    slr_diff = pd.DataFrame({'Actual value': Y_test, 'Predicted value': y_pred_slr})
    slr_diff.to_csv('../data/slr_diff.csv', index=False)
    print('Resultados guardados correctamente')
  #calculando el R cuadrado
    r_squared = r2_score(Y_test, y_pred_slr)
    print('R cuadrado del modelo: {:.2f}'.format(r_squared))